from btb.data_sources import odds_the_odds_api

@app.command("ingest-odds")
def ingest_odds(
    league: str = typer.Argument("NBA"),
    date: str = typer.Option(..., "--date", help="YYYY-MM-DD"),
    sport_key: str = typer.Option(None, "--sport-key", help="Override The Odds API sport key"),
) -> None:
    target_date = datetime.date.fromisoformat(date)
    result = odds_the_odds_api.ingest_day_main_markets(league, target_date, sport_key=sport_key)
    typer.echo(result)
